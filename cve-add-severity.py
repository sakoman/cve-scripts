#! /usr/bin/env python3

import sys
import requests

from bs4 import BeautifulSoup


with sys.stdin as inp:
    inp_content = inp.read()

inp_lines = inp_content.split('\n')
out_content = ""
for line in inp_lines:
    if "CVE-" in line:
        semic_indx = line.find(":")
        cve_id = line[:semic_indx]

        response = requests.get('https://nvd.nist.gov/vuln/detail/'+cve_id)
        soup = BeautifulSoup(response.content, 'html.parser')

        try:
            cve_cvss = soup.find_all(id="Cvss3NistCalculatorAnchor")[0].get_text()
        except:
            # If NIST CVSS is not found the it has the same value as the CNA CVSS
            try:
                cve_cvss = soup.find_all(id="Cvss3CnaCalculatorAnchor")[0].get_text()
            except:
                cve_cvss = "N/A"

        cve_out_line = line[:semic_indx] + f" (CVSS3: {cve_cvss})" + line[semic_indx:]
        print(cve_out_line)

    else:
        print(line)
